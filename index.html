git <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Palisades Gold Radio - Market Risk Dashboard (Live Data)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #0a0e27 0%, #151932 100%);
            color: #e0e6ed;
            min-height: 100vh;
            padding: 20px;
        }

        .dashboard-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(20, 25, 45, 0.7);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 215, 0, 0.2);
        }

        .dashboard-header h1 {
            color: #ffd700;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }

        .subtitle {
            color: #8892b0;
            font-size: 1.1rem;
        }

        .last-updated {
            margin-top: 10px;
            color: #64ffda;
            font-size: 0.9rem;
        }

        .api-status {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .api-indicator {
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .api-indicator.success {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }

        .api-indicator.error {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        .api-indicator.loading {
            background: rgba(251, 191, 36, 0.2);
            color: #fbbf24;
        }

        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: currentColor;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .metric-card {
            background: rgba(20, 25, 45, 0.9);
            border-radius: 12px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(100, 255, 218, 0.1);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .metric-card.loading {
            opacity: 0.7;
        }

        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #64ffda, #ffd700);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(100, 255, 218, 0.2);
        }

        .metric-card:hover::before {
            opacity: 1;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .card-title {
            font-size: 1.2rem;
            color: #ccd6f6;
            font-weight: 600;
        }

        .card-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .badge-commodity {
            background: rgba(255, 193, 7, 0.2);
            color: #ffc107;
        }

        .badge-macro {
            background: rgba(100, 255, 218, 0.2);
            color: #64ffda;
        }

        .badge-gold {
            background: rgba(255, 215, 0, 0.2);
            color: #ffd700;
        }

        .badge-crypto {
            background: rgba(147, 51, 234, 0.2);
            color: #9333ea;
        }

        .badge-equity {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
        }

        .metric-value {
            font-size: 2rem;
            font-weight: 700;
            margin: 10px 0;
        }

        .metric-change {
            font-size: 1.2rem;
            margin-left: 10px;
            font-weight: 500;
        }

        .positive {
            color: #10b981;
        }

        .negative {
            color: #ef4444;
        }

        .neutral {
            color: #64ffda;
        }

        .metric-description {
            color: #8892b0;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin-top: 15px;
        }

        .wide-card {
            grid-column: span 2;
        }

        .performance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .performance-item {
            text-align: center;
            padding: 15px;
            background: rgba(30, 35, 55, 0.5);
            border-radius: 8px;
            border: 1px solid rgba(100, 255, 218, 0.1);
            transition: all 0.3s ease;
        }

        .performance-item:hover {
            background: rgba(30, 35, 55, 0.8);
            transform: scale(1.05);
        }

        .performance-label {
            color: #8892b0;
            font-size: 0.85rem;
            margin-bottom: 8px;
        }

        .performance-value {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .warning-box {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }

        .warning-title {
            color: #ef4444;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .correlation-indicator {
            width: 100%;
            height: 40px;
            background: linear-gradient(90deg, #10b981 0%, #fbbf24 50%, #ef4444 100%);
            border-radius: 20px;
            position: relative;
            margin-top: 15px;
        }

        .correlation-marker {
            position: absolute;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .loading-spinner {
            border: 3px solid rgba(100, 255, 218, 0.1);
            border-top: 3px solid #64ffda;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error-message {
            color: #ef4444;
            font-size: 0.85rem;
            margin-top: 10px;
            padding: 10px;
            background: rgba(239, 68, 68, 0.1);
            border-radius: 6px;
        }

        .live-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #10b981;
            border-radius: 50%;
            margin-left: 8px;
            animation: live-pulse 2s infinite;
        }

        @keyframes live-pulse {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7);
            }
            50% {
                box-shadow: 0 0 0 10px rgba(16, 185, 129, 0);
            }
        }

        .setup-instructions {
            background: rgba(251, 191, 36, 0.1);
            border: 1px solid rgba(251, 191, 36, 0.3);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            color: #fbbf24;
        }

        .setup-instructions h3 {
            margin-bottom: 15px;
            color: #ffd700;
        }

        .setup-instructions ol {
            margin-left: 20px;
        }

        .setup-instructions li {
            margin-bottom: 10px;
        }

        .setup-instructions a {
            color: #64ffda;
            text-decoration: none;
        }

        .setup-instructions a:hover {
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .wide-card {
                grid-column: span 1;
            }
            
            .dashboard-header h1 {
                font-size: 1.8rem;
            }

            .performance-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-header">
        <h1>üèÜ Palisades Gold Radio Dashboard</h1>
        <div class="subtitle">Mike McGlone: Markets Entering Serious Systemic Risk</div>
        <div class="last-updated">
            Last Updated: <span id="updateTime"></span>
            <span class="live-indicator"></span>
        </div>
        <div class="api-status" id="apiStatus">
            <div class="api-indicator loading">
                <span class="status-dot"></span>
                <span>Initializing APIs...</span>
            </div>
        </div>
    </div>

    <div class="setup-instructions" id="setupInstructions">
        <h3>üîß API Setup Instructions</h3>
        <p>To enable real-time data, add your free API keys to the CONFIG section in the code:</p>
        <ol>
            <li><strong>Alpha Vantage</strong> (stocks/commodities): <a href="https://www.alphavantage.co/support/#api-key" target="_blank">Get free key</a></li>
            <li><strong>FRED</strong> (economic data): <a href="https://fred.stlouisfed.org/docs/api/api_key.html" target="_blank">Get free key</a></li>
            <li><strong>Financial Modeling Prep</strong> (alternative): <a href="https://financialmodelingprep.com/developer/docs" target="_blank">Get free key</a></li>
        </ol>
        <p>CoinGecko crypto data works without API keys. Some fallback data is shown below.</p>
    </div>

    <div class="dashboard-grid" id="dashboardGrid">
        <!-- Cards will be dynamically generated -->
    </div>

    <script>
        // Configuration - Add your API keys here
        const CONFIG = {
            // Get free API keys from these providers
            ALPHA_VANTAGE_KEY: '', // https://www.alphavantage.co/support/#api-key
            FRED_API_KEY: '', // https://fred.stlouisfed.org/docs/api/api_key.html
            FMP_API_KEY: '', // https://financialmodelingprep.com/developer/docs
            
            // Update intervals (milliseconds)
            UPDATE_INTERVAL: 300000, // 5 minutes
            
            // Cache duration
            CACHE_DURATION: 60000 // 1 minute
        };

        // Data cache
        const dataCache = new Map();

        // API status tracker
        const apiStatus = {
            coingecko: 'loading',
            stocks: 'loading',
            commodities: 'loading',
            forex: 'loading'
        };

        // Real-time data fetchers
        class MarketDataFetcher {
            constructor() {
                this.charts = {};
            }

            // Check if we have API keys configured
            hasApiKeys() {
                return CONFIG.ALPHA_VANTAGE_KEY || CONFIG.FRED_API_KEY || CONFIG.FMP_API_KEY;
            }

            // Fetch cryptocurrency data from CoinGecko (no API key needed)
            async fetchCryptoData() {
                try {
                    console.log('Fetching crypto data from CoinGecko...');
                    const response = await axios.get('https://api.coingecko.com/api/v3/simple/price', {
                        params: {
                            ids: 'bitcoin,ethereum,tether,usd-coin,binance-usd,dai',
                            vs_currencies: 'usd',
                            include_24hr_change: true,
                            include_market_cap: true
                        }
                    });
                    
                    apiStatus.coingecko = 'success';
                    console.log('CoinGecko data:', response.data);
                    return response.data;
                } catch (error) {
                    console.error('CoinGecko API error:', error);
                    apiStatus.coingecko = 'error';
                    return null;
                }
            }

            // Fetch gold price using multiple sources
            async fetchGoldPrice() {
                try {
                    // Try metals-api.com first (free tier)
                    console.log('Fetching gold price...');
                    const response = await axios.get('https://api.metals.live/v1/spot/gold');
                    return {
                        price: response.data.price,
                        change: 28.5 // YTD from podcast
                    };
                } catch (error) {
                    console.log('Using fallback gold price');
                    // Known values from the podcast
                    return { 
                        price: 2650, 
                        change: 28.5,
                        source: 'podcast_data'
                    };
                }
            }

            // Fetch S&P 500 data using Financial Modeling Prep or fallback
            async fetchSP500() {
                if (CONFIG.FMP_API_KEY) {
                    try {
                        console.log('Fetching S&P 500 data from FMP...');
                        const response = await axios.get(`https://financialmodelingprep.com/api/v3/quote/%5EGSPC?apikey=${CONFIG.FMP_API_KEY}`);
                        if (response.data && response.data[0]) {
                            const data = response.data[0];
                            return {
                                price: data.price,
                                change: data.changesPercentage,
                                ytdChange: 24.1 // From podcast
                            };
                        }
                    } catch (error) {
                        console.error('FMP S&P 500 error:', error);
                    }
                }

                // Try Yahoo Finance alternative
                try {
                    console.log('Trying alternative S&P 500 source...');
                    const response = await axios.get('https://query1.finance.yahoo.com/v8/finance/chart/%5EGSPC');
                    if (response.data && response.data.chart && response.data.chart.result) {
                        const result = response.data.chart.result[0];
                        const price = result.meta.regularMarketPrice;
                        const previousClose = result.meta.previousClose;
                        const change = ((price - previousClose) / previousClose * 100);
                        
                        apiStatus.stocks = 'success';
                        return { 
                            price: price.toFixed(2), 
                            change: change.toFixed(2),
                            ytdChange: 24.1
                        };
                    }
                } catch (error) {
                    console.error('Yahoo Finance error:', error);
                    apiStatus.stocks = 'error';
                }

                // Fallback to known values
                return { 
                    price: 5800, 
                    change: 0.5,
                    ytdChange: 24.1,
                    source: 'fallback'
                };
            }

            // Fetch oil price
            async fetchOilPrice() {
                if (CONFIG.ALPHA_VANTAGE_KEY) {
                    try {
                        console.log('Fetching oil price from Alpha Vantage...');
                        const response = await axios.get('https://www.alphavantage.co/query', {
                            params: {
                                function: 'WTI',
                                interval: 'daily',
                                apikey: CONFIG.ALPHA_VANTAGE_KEY
                            }
                        });
                        
                        if (response.data && response.data.data) {
                            const latest = response.data.data[0];
                            return {
                                price: parseFloat(latest.value),
                                change: -9.0 // YTD from podcast
                            };
                        }
                    } catch (error) {
                        console.error('Alpha Vantage oil error:', error);
                    }
                }

                // Fallback to podcast values
                return { 
                    price: 74.5, 
                    change: -9.0,
                    source: 'podcast_data'
                };
            }

            // China 10Y Bond Yield (from podcast - real-time requires premium APIs)
            async fetchChinaBondYield() {
                return { 
                    yield: 1.71, 
                    change: -39.3,
                    description: "Historic low indicating severe deflationary pressures",
                    source: 'podcast_data'
                };
            }

            // Market Cap to GDP (Buffett Indicator)
            async fetchBuffettIndicator() {
                if (CONFIG.FRED_API_KEY) {
                    try {
                        console.log('Fetching Buffett Indicator from FRED...');
                        const response = await axios.get('https://api.stlouisfed.org/fred/series/observations', {
                            params: {
                                series_id: 'DDDM01USA156NWDB',
                                api_key: CONFIG.FRED_API_KEY,
                                file_type: 'json',
                                limit: 1,
                                sort_order: 'desc'
                            }
                        });
                        
                        if (response.data && response.data.observations) {
                            const value = parseFloat(response.data.observations[0].value);
                            return { value, historicalPeaks: [145, 142, 148] };
                        }
                    } catch (error) {
                        console.error('FRED API error:', error);
                    }
                }
                
                // Known extreme level from podcast
                return { 
                    value: 185, 
                    historicalPeaks: [145, 142, 148],
                    source: 'podcast_data'
                };
            }

            // Calculate Bitcoin-S&P correlation (simplified)
            async calculateBTCCorrelation() {
                return { 
                    correlation: 0.72,
                    description: "High correlation shows 'leverage beta' to equities",
                    source: 'podcast_data'
                };
            }

            // Get stablecoin market cap
            async getStablecoinMarketCap() {
                try {
                    console.log('Fetching stablecoin data...');
                    const response = await axios.get('https://api.coingecko.com/api/v3/coins/markets', {
                        params: {
                            vs_currency: 'usd',
                            ids: 'tether,usd-coin,binance-usd,dai,true-usd,frax',
                            order: 'market_cap_desc'
                        }
                    });
                    
                    const totalMarketCap = response.data.reduce((sum, coin) => sum + coin.market_cap, 0);
                    return { 
                        marketCap: (totalMarketCap / 1e9).toFixed(1),
                        change: 28 // From podcast
                    };
                } catch (error) {
                    console.error('Stablecoin data error:', error);
                    return { 
                        marketCap: 160,
                        change: 28,
                        source: 'fallback'
                    };
                }
            }

            // Fetch commodity prices
            async fetchCommodityPrices() {
                return {
                    copper: {
                        current: 4.20,
                        target: 3.00,
                        change: -28.6, // Projected decline
                        source: 'podcast_prediction'
                    },
                    grains: {
                        corn: { price: 5.70, change: -16.2 },
                        wheat: { price: 6.90, change: -15.8 },
                        soybeans: { price: 12.20, change: -15.9 },
                        indexChange: -16.0
                    }
                };
            }

            // Central bank gold purchases (known data)
            async getCentralBankGold() {
                return {
                    total2023: 1037,
                    q1_2024: 290,
                    q2_2024: 183,
                    trend: 'increasing',
                    source: 'central_bank_reports'
                };
            }

            // Gold ETF flows
            async getGoldETFFlows() {
                return {
                    ytdChange: 10,
                    description: "First increase after 4 years of outflows",
                    historicalFlows: [200, 875, -173, -110, -244, 95], // 2019-2024
                    years: ['2019', '2020', '2021', '2022', '2023', '2024'],
                    source: 'etf_reports'
                };
            }
        }

        // Initialize dashboard
        class Dashboard {
            constructor() {
                this.fetcher = new MarketDataFetcher();
                this.charts = {};
                this.init();
            }

            async init() {
                this.updateTime();
                this.updateApiStatus();
                
                // Check if API keys are configured
                if (!this.fetcher.hasApiKeys()) {
                    document.getElementById('setupInstructions').style.display = 'block';
                } else {
                    document.getElementById('setupInstructions').style.display = 'none';
                }

                await this.loadAllData();
                this.startAutoRefresh();
            }

            updateTime() {
                document.getElementById('updateTime').textContent = new Date().toLocaleString();
            }

            updateApiStatus() {
                const statusContainer = document.getElementById('apiStatus');
                statusContainer.innerHTML = '';
                
                Object.entries(apiStatus).forEach(([api, status]) => {
                    const indicator = document.createElement('div');
                    indicator.className = `api-indicator ${status}`;
                    indicator.innerHTML = `
                        <span class="status-dot"></span>
                        <span>${api.toUpperCase()}: ${status}</span>
                    `;
                    statusContainer.appendChild(indicator);
                });
            }

            async loadAllData() {
                const grid = document.getElementById('dashboardGrid');
                
                // Show loading
                if (grid.children.length === 0) {
                    grid.innerHTML = '<div class="loading-spinner"></div>';
                }

                try {
                    console.log('Loading all market data...');
                    
                    // Fetch all data in parallel
                    const [
                        cryptoData,
                        goldData,
                        oilData,
                        sp500Data,
                        chinaYield,
                        buffettIndicator,
                        btcCorrelation,
                        stablecoinCap,
                        commodityPrices,
                        centralBankGold,
                        goldETFFlows
                    ] = await Promise.all([
                        this.fetcher.fetchCryptoData(),
                        this.fetcher.fetchGoldPrice(),
                        this.fetcher.fetchOilPrice(),
                        this.fetcher.fetchSP500(),
                        this.fetcher.fetchChinaBondYield(),
                        this.fetcher.fetchBuffettIndicator(),
                        this.fetcher.calculateBTCCorrelation(),
                        this.fetcher.getStablecoinMarketCap(),
                        this.fetcher.fetchCommodityPrices(),
                        this.fetcher.getCentralBankGold(),
                        this.fetcher.getGoldETFFlows()
                    ]);

                    // Clear loading spinner
                    grid.innerHTML = '';

                    // Create cards with real data
                    this.createCards({
                        cryptoData,
                        goldData,
                        oilData,
                        sp500Data,
                        chinaYield,
                        buffettIndicator,
                        btcCorrelation,
                        stablecoinCap,
                        commodityPrices,
                        centralBankGold,
                        goldETFFlows
                    });

                    this.updateApiStatus();
                    this.updateTime();

                    console.log('Dashboard loaded successfully');

                } catch (error) {
                    console.error('Dashboard loading error:', error);
                    grid.innerHTML = `
                        <div class="error-message">
                            <strong>Error loading data:</strong> ${error.message}<br>
                            Please check your internet connection and API keys.
                        </div>
                    `;
                }
            }

            createCards(data) {
                const grid = document.getElementById('dashboardGrid');
                
                // Gold Price Card
                this.createMetricCard(grid, {
                    title: 'ü•á Gold Price',
                    badge: 'GOLD',
                    badgeClass: 'badge-gold',
                    value: `$${data.goldData.price}/oz`,
                    change: `+${data.goldData.change}%`,
                    changeClass: 'positive',
                    description: 'Year-to-date performance, targeting $4,000 (McGlone prediction)',
                    source: data.goldData.source
                });

                // Bitcoin Card
                if (data.cryptoData && data.cryptoData.bitcoin) {
                    const btc = data.cryptoData.bitcoin;
                    const btcYTD = 115; // Approximate YTD from $43k start of year
                    
                    this.createMetricCard(grid, {
                        title: '‚Çø Bitcoin',
                        badge: 'CRYPTO',
                        badgeClass: 'badge-crypto',
                        value: `$${btc.usd.toLocaleString()}`,
                        change: `${btc.usd_24h_change > 0 ? '+' : ''}${btc.usd_24h_change.toFixed(1)}%`,
                        changeClass: btc.usd_24h_change > 0 ? 'positive' : 'negative',
                        description: `24h change | YTD: +${btcYTD}% | Correlation with S&P: ${data.btcCorrelation.correlation}`
                    });
                }

                // S&P 500 Card
                this.createMetricCard(grid, {
                    title: 'üìà S&P 500',
                    badge: 'EQUITY',
                    badgeClass: 'badge-equity',
                    value: data.sp500Data.price.toLocaleString(),
                    change: `${data.sp500Data.change > 0 ? '+' : ''}${data.sp500Data.change}%`,
                    changeClass: data.sp500Data.change > 0 ? 'positive' : 'negative',
                    description: `24h change | YTD: +${data.sp500Data.ytdChange}%`,
                    source: data.sp500Data.source
                });

                // Crude Oil Card
                this.createMetricCard(grid, {
                    title: 'üõ¢Ô∏è Crude Oil (WTI)',
                    badge: 'COMMODITY',
                    badgeClass: 'badge-commodity',
                    value: `$${data.oilData.price}`,
                    change: `${data.oilData.change}%`,
                    changeClass: 'negative',
                    description: 'Year-to-date decline from 2022 inflationary peak',
                    source: data.oilData.source
                });

                // China Bond Yield Card
                this.createMetricCard(grid, {
                    title: 'üá®üá≥ China 10Y Bond',
                    badge: 'MACRO',
                    badgeClass: 'badge-macro',
                    value: `${data.chinaYield.yield}%`,
                    change: `${data.chinaYield.change}% vs peak`,
                    changeClass: 'negative',
                    description: data.chinaYield.description
                });

                // Buffett Indicator Card (Wide)
                const buffettCard = this.createMetricCard(grid, {
                    title: 'üìä Market Cap / GDP Ratio (Buffett Indicator)',
                    badge: 'MACRO',
                    badgeClass: 'badge-macro',
                    value: `${data.buffettIndicator.value}%`,
                    change: 'EXTREME HIGH',
                    changeClass: 'negative',
                    description: '',
                    wide: true
                });

                // Add warning box to Buffett card
                const warningBox = document.createElement('div');
                warningBox.className = 'warning-box';
                warningBox.innerHTML = `
                    <div class="warning-title">‚ö†Ô∏è Historical Peak Warning</div>
                    <div class="metric-description">
                        Current levels (${data.buffettIndicator.value}%) exceed 1929 (145%), 1989 (142%), and 2000 (148%) peaks.
                        McGlone suggests extreme overvaluation and systemic risk.
                    </div>
                `;
                buffettCard.appendChild(warningBox);

                // YTD Performance Comparison (Wide)
                this.createPerformanceCard(grid, data);

                // Copper Forecast Card
                this.createMetricCard(grid, {
                    title: 'üîß Copper Forecast',
                    badge: 'COMMODITY',
                    badgeClass: 'badge-commodity',
                    value: `$${data.commodityPrices.copper.current} ‚Üí $${data.commodityPrices.copper.target}`,
                    change: `${data.commodityPrices.copper.change}%`,
                    changeClass: 'negative',
                    description: 'McGlone\'s prediction due to tariff impacts and demand decline'
                });

                // Grains Index Card
                this.createMetricCard(grid, {
                    title: 'üåæ Grains Index',
                    badge: 'COMMODITY',
                    badgeClass: 'badge-commodity',
                    value: `${data.commodityPrices.grains.indexChange}%`,
                    change: 'YTD',
                    changeClass: 'negative',
                    description: 'Corn, wheat, soybeans decline from 2022 peaks'
                });

                // Stablecoin Market Cap
                this.createMetricCard(grid, {
                    title: 'üíµ Stablecoin Market',
                    badge: 'CRYPTO',
                    badgeClass: 'badge-crypto',
                    value: `$${data.stablecoinCap.marketCap}B`,
                    change: `+${data.stablecoinCap.change}%`,
                    changeClass: 'positive',
                    description: 'Total market cap showing growing global dollar demand'
                });

                // Gold ETF Flows
                this.createMetricCard(grid, {
                    title: 'üí∞ Gold ETF Holdings',
                    badge: 'GOLD',
                    badgeClass: 'badge-gold',
                    value: `+${data.goldETFFlows.ytdChange}%`,
                    change: 'YTD',
                    changeClass: 'positive',
                    description: data.goldETFFlows.description
                });

                // Central Bank Gold Purchases
                this.createMetricCard(grid, {
                    title: 'üè¶ Central Bank Gold',
                    badge: 'GOLD',
                    badgeClass: 'badge-gold',
                    value: `${data.centralBankGold.total2023} tons`,
                    change: '2023 Record',
                    changeClass: 'positive',
                    description: `Q1 2024: ${data.centralBankGold.q1_2024} tons | Q2 2024: ${data.centralBankGold.q2_2024} tons`
                });

                // Bitcoin-S&P Correlation
                const correlationCard = this.createMetricCard(grid, {
                    title: '‚Çø BTC-S&P Correlation',
                    badge: 'CRYPTO',
                    badgeClass: 'badge-crypto',
                    value: data.btcCorrelation.correlation,
                    change: '',
                    changeClass: 'neutral',
                    description: data.btcCorrelation.description
                });

                // Add correlation indicator
                const correlationIndicator = document.createElement('div');
                correlationIndicator.className = 'correlation-indicator';
                correlationIndicator.innerHTML = `
                    <div class="correlation-marker" style="left: ${data.btcCorrelation.correlation * 100}%;"></div>
                `;
                correlationCard.appendChild(correlationIndicator);
            }

            createMetricCard(container, config) {
                const card = document.createElement('div');
                card.className = `metric-card ${config.wide ? 'wide-card' : ''}`;
                
                card.innerHTML = `
                    <div class="card-header">
                        <h3 class="card-title">${config.title}</h3>
                        <span class="card-badge ${config.badgeClass}">${config.badge}</span>
                    </div>
                    <div class="metric-value ${config.changeClass}">
                        ${config.value}
                        ${config.change ? `<span class="metric-change">${config.change}</span>` : ''}
                    </div>
                    ${config.description ? `<div class="metric-description">${config.description}</div>` : ''}
                    ${config.source ? `<div class="metric-description" style="font-style: italic; margin-top: 8px;">Source: ${config.source}</div>` : ''}
                `;
                
                container.appendChild(card);
                return card;
            }

            createPerformanceCard(container, data) {
                const card = document.createElement('div');
                card.className = 'metric-card wide-card';
                
                // Calculate Bitcoin YTD (approximate)
                const btcPrice = data.cryptoData?.bitcoin?.usd || 95000;
                const btcYTD = 115; // Approximate from $43k start of year
                
                card.innerHTML = `
                    <div class="card-header">
                        <h3 class="card-title">üìä Year-to-Date Asset Performance</h3>
                        <span class="card-badge badge-macro">PERFORMANCE</span>
                    </div>
                    <div class="performance-grid">
                        <div class="performance-item">
                            <div class="performance-label">Bitcoin</div>
                            <div class="performance-value positive">+${btcYTD}%</div>
                        </div>
                        <div class="performance-item">
                            <div class="performance-label">Gold</div>
                            <div class="performance-value positive">+28.5%</div>
                        </div>
                        <div class="performance-item">
                            <div class="performance-label">S&P 500</div>
                            <div class="performance-value positive">+24.1%</div>
                        </div>
                        <div class="performance-item">
                            <div class="performance-label">Treasury Bonds</div>
                            <div class="performance-value positive">+3.2%</div>
                        </div>
                        <div class="performance-item">
                            <div class="performance-label">Crude Oil</div>
                            <div class="performance-value negative">-9.0%</div>
                        </div>
                        <div class="performance-item">
                            <div class="performance-label">Grains</div>
                            <div class="performance-value negative">-16.0%</div>
                        </div>
                    </div>
                    <div class="metric-description" style="margin-top: 15px;">
                        Performance comparison showing asset class divergence. Bitcoin leading gains, commodities lagging.
                    </div>
                `;
                
                container.appendChild(card);
            }

            startAutoRefresh() {
                setInterval(() => {
                    console.log('Auto-refreshing dashboard...');
                    this.loadAllData();
                }, CONFIG.UPDATE_INTERVAL);
            }
        }

        // Initialize dashboard when page loads
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Initializing Palisades Gold Radio Dashboard...');
            const dashboard = new Dashboard();
            
            // Add refresh on Ctrl+R
            document.addEventListener('keydown', (e) => {
                if (e.key === 'r' && e.ctrlKey) {
                    e.preventDefault();
                    console.log('Manual refresh triggered');
                    dashboard.loadAllData();
                }
            });

            // Add click-to-refresh on header
            document.querySelector('.dashboard-header').addEventListener('click', () => {
                dashboard.loadAllData();
            });
        });

        // Error handling
        window.addEventListener('unhandledrejection', event => {
            console.error('Unhandled promise rejection:', event.reason);
        });

        // Set Chart.js defaults for consistent styling
        Chart.defaults.color = '#8892b0';
        Chart.defaults.borderColor = 'rgba(100, 255, 218, 0.1)';
        Chart.defaults.font.family = '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif';
    </script>
</body>
</html>
